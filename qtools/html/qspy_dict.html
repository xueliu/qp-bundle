<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QTools: QSPY Dictionaries</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a id="logo" title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com"></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QTools
   &#160;<span id="projectnumber">6.8.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('qspy_dict.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">QSPY Dictionaries </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#qspy_dict_about">About QSPY Dictionaries</a></li>
<li class="level1"><a href="#qspy_dict_get">Acquiring Dictionaries</a></li>
<li class="level1"><a href="#qspy_dict_save">Saving Dictionaries to a File</a></li>
<li class="level1"><a href="#qspy_dict_use">Using Dictionary File</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="qspy_dict_about"></a>
About QSPY Dictionaries</h1>
<p>By the time you compile and load your application image to the Target, the symbolic names of various objects, function names, and event signal names are stripped from the code. Therefore, if you want to have the symbolic information available to the QSPY host-resident component, you need to supply it somehow to the software tracing system.</p>
<p>The QS Target-resident component provides special <a class="el" href="qs.html#qs_dict">dictionary trace records</a> designed expressly for providing the symbolic information about the target code in the trace itself. These "dictionary records" are very much like the symbolic information embedded in the object files for the traditional single-step debugger. QS can supply four types of dictionary trace records:</p>
<ul>
<li>object dictionary &ndash; for identifying objects (HSMs, AOs, Time events, etc)</li>
<li>function dictionary &ndash; for identifying functions (state-handlers)</li>
<li>signal dictionary &ndash; for identifying event signals</li>
<li>user dictionary &ndash; for identifying <a class="el" href="qs.html#qs_app">application-specific</a> (user) records</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>QSPY does not absolutely require the presence of dictionary trace records to generate the human-readable output, in the same way as the symbolic information in the object files is not absolutely required to debug code. However, in both cases, the availability of the symbolic information greatly improves the readability of the disassembly code shown in the debugger.</dd></dl>
<p>For instance, the following listing shows an example of the QSPY text output when the "dictionaries" are <b>not</b> available. (<b>NOTE:</b> dictionaries might not be available because (1) the Target does not produce <a class="el" href="qs.html#qs_dict">dictionary trace records</a> for all relevant objects or (2) the Target does produce all dictionaries, but QSPY has never seen them, because it was attached to the Target after the dictionaries have been transmitted): <br  />
</p><pre class="fragment">. . . . . .
0009692721 Disp===&gt; Obj=0x2000133C,Sig=00000010,Obj=0x2000133C,State=0x000010C5
0009693389 USER+000 4 hungry
0009695383 USER+000 4 eating
0009695932 =&gt;Intern Obj=0x2000133C,Sig=00000010,Obj=0x2000133C,State=0x000010C5
===RTC===&gt; St-Entry Obj=0x200012F8,State=0x00000D49
0009697188 ===&gt;Tran Obj=0x200012F8,Sig=00000011,Obj=0x200012F8,State=0x00000DD5-&gt;0x00000D49
0009698052 Disp===&gt; Obj=0x200012F8,Sig=00000004,Obj=0x200012F8,State=0x00000D49
===RTC===&gt; St-Entry Obj=0x200012F8,State=0x00000CA9
0009699697 ===&gt;Tran Obj=0x200012F8,Sig=00000004,Obj=0x200012F8,State=0x00000D49-&gt;0x00000CA9
0009700602 Disp===&gt; Obj=0x200012B8,Sig=00000004,Obj=0x200012B8,State=0x00000DD5
0009701247 =&gt;Intern Obj=0x200012B8,Sig=00000004,Obj=0x200012B8,State=0x00000DD5
0009702038 Disp===&gt; Obj=0x20001278,Sig=00000004,Obj=0x20001278,State=0x00000DD5
0009702677 =&gt;Intern Obj=0x20001278,Sig=00000004,Obj=0x20001278,State=0x00000DD5
0009703468 Disp===&gt; Obj=0x20001238,Sig=00000004,Obj=0x20001238,State=0x00000DD5
0009704107 =&gt;Intern Obj=0x20001238,Sig=00000004,Obj=0x20001238,State=0x00000DD5
0009704899 Disp===&gt; Obj=0x200011F8,Sig=00000004,Obj=0x200011F8,State=0x00000DD5
0009705538 =&gt;Intern Obj=0x200011F8,Sig=00000004,Obj=0x200011F8,State=0x00000DD5
0015961105 Disp===&gt; Obj=0x200011F8,Sig=00000011,Obj=0x200011F8,State=0x00000DD5
===RTC===&gt; St-Exit  Obj=0x200011F8,State=0x00000DD5
0015962823 Disp===&gt; Obj=0x2000133C,Sig=00000010,Obj=0x2000133C,State=0x000010C5
0015963491 USER+000 0 hungry
. . . . . .
</pre><p>And here is the exact same trace data when the "dictionaries" <b>are</b> available:</p>
<pre class="fragment">. . . . . .
0009692721 Disp===&gt; Obj=l_table,Sig=HUNGRY_SIG,State=Table_serving
0009693389 PHILO_STAT 4 hungry
0009695383 PHILO_STAT 4 eating
0009695932 =&gt;Intern Obj=l_table,Sig=HUNGRY_SIG,State=Table_serving
===RTC===&gt; St-Entry Obj=l_philo&lt;4&gt;,State=Philo_hungry
0009697188 ===&gt;Tran Obj=l_philo&lt;4&gt;,Sig=TIMEOUT_SIG,State=Philo_thinking-&gt;Philo_hungry
0009698052 Disp===&gt; Obj=l_philo&lt;4&gt;,Sig=EAT_SIG,State=Philo_hungry
===RTC===&gt; St-Entry Obj=l_philo&lt;4&gt;,State=Philo_eating
0009699697 ===&gt;Tran Obj=l_philo&lt;4&gt;,Sig=EAT_SIG,State=Philo_hungry-&gt;Philo_eating
0009700602 Disp===&gt; Obj=l_philo&lt;3&gt;,Sig=EAT_SIG,State=Philo_thinking
0009701247 =&gt;Intern Obj=l_philo&lt;3&gt;,Sig=EAT_SIG,State=Philo_thinking
0009702038 Disp===&gt; Obj=l_philo&lt;2&gt;,Sig=EAT_SIG,State=Philo_thinking
0009702677 =&gt;Intern Obj=l_philo&lt;2&gt;,Sig=EAT_SIG,State=Philo_thinking
0009703468 Disp===&gt; Obj=l_philo&lt;1&gt;,Sig=EAT_SIG,State=Philo_thinking
0009704107 =&gt;Intern Obj=l_philo&lt;1&gt;,Sig=EAT_SIG,State=Philo_thinking
0009704899 Disp===&gt; Obj=l_philo&lt;0&gt;,Sig=EAT_SIG,State=Philo_thinking
0009705538 =&gt;Intern Obj=l_philo&lt;0&gt;,Sig=EAT_SIG,State=Philo_thinking
0015961105 Disp===&gt; Obj=l_philo&lt;0&gt;,Sig=TIMEOUT_SIG,State=Philo_thinking
===RTC===&gt; St-Exit  Obj=l_philo&lt;0&gt;,State=Philo_thinking
0015962823 Disp===&gt; Obj=l_table,Sig=HUNGRY_SIG,State=Table_serving
0015963491 PHILO_STAT 0 hungry
. . . . . .
</pre><p>As you can see, the difference in readability is quite dramatic.</p>
<hr  />
 <h1><a class="anchor" id="qspy_dict_get"></a>
Acquiring Dictionaries</h1>
<p>The QS Target-resident component generates the dictionary trace records during the initialization of active objects components in the Target code, that is, typically right after the reset. Consequently, the best way to acquire the dictionaries is to capture the trace when the Target performs the reset. This can be done in a couple of ways:</p><ul>
<li>Start QSPY <b>before</b> the Target resets</li>
<li>Manually reset the Target while QSPY is running (e.g., press a Reset button on the Target board)</li>
<li>Send the <a class="el" href="qspy.html#qspy_keyboard">RESET command</a> to the Target from QSPY while it is running</li>
</ul>
<p>Either way, the dictionary records should be produced and acquired by the Target. The following listing shows the dictionary records sent by the DPP example application running on the EFM32-SLSTK3401A board:</p>
<pre class="fragment">C:\qp\qpc\examples\arm-cm\dpp_efm32-slstk3401a\qxk\gnu&gt;qspy -cCOM6
QSPY 6.1.0 Copyright (c) 2005-2018 Quantum Leaps
Documentation: https://www.state-machine.com/qtools/qspy.html
Current timestamp: 180119_195728
-u 7701
-c COM7
-v 600
-T 4
-O 4
-F 4
-S 2
-E 2
-Q 1
-P 2
-B 2
-C 2

########## Trg-RST  QP-Ver=604,Build=180117_155932
           Obj-Dict 0x00007322-&gt;QS_RX
           Obj-Dict 0x20000D3C-&gt;l_SysTick_Handler
           Obj-Dict 0x20000D3D-&gt;l_GPIOPortA_IRQHandler
           Usr-Dict 00000070-&gt;PHILO_STAT
           Usr-Dict 00000071-&gt;PAUSED_STAT
           Usr-Dict 00000072-&gt;COMMAND_STAT
           Obj-Dict 0x200015D0-&gt;smlPoolSto
           Obj-Dict 0x20001684-&gt;tableQueueSto
           Obj-Dict 0x20001620-&gt;philoQueueSto&lt;0&gt;
           Obj-Dict 0x20001634-&gt;philoQueueSto&lt;1&gt;
           Obj-Dict 0x20001648-&gt;philoQueueSto&lt;2&gt;
           Obj-Dict 0x2000165C-&gt;philoQueueSto&lt;3&gt;
           Obj-Dict 0x20001670-&gt;philoQueueSto&lt;4&gt;
           Obj-Dict 0x20001AEC-&gt;l_philo&lt;0&gt;
           Obj-Dict 0x20001B14-&gt;l_philo&lt;0&gt;.m_timeEvt
           Obj-Dict 0x20001B24-&gt;l_philo&lt;1&gt;
           Obj-Dict 0x20001B4C-&gt;l_philo&lt;1&gt;.m_timeEvt
           Obj-Dict 0x20001B5C-&gt;l_philo&lt;2&gt;
           Obj-Dict 0x20001B84-&gt;l_philo&lt;2&gt;.m_timeEvt
           Obj-Dict 0x20001B94-&gt;l_philo&lt;3&gt;
           Obj-Dict 0x20001BBC-&gt;l_philo&lt;3&gt;.m_timeEvt
           Obj-Dict 0x20001BCC-&gt;l_philo&lt;4&gt;
           Obj-Dict 0x20001BF4-&gt;l_philo&lt;4&gt;.m_timeEvt
           Fun-Dict 0x000026C5-&gt;Philo::initial
           Fun-Dict 0x000027E1-&gt;Philo::thinking
           Fun-Dict 0x0000287D-&gt;Philo::hungry
           Fun-Dict 0x00002925-&gt;Philo::eating
           Sig-Dict 00000010,Obj=0x20001AEC-&gt;HUNGRY_SIG
           Sig-Dict 00000011,Obj=0x20001AEC-&gt;TIMEOUT_SIG
. . .      . . .
           Obj-Dict 0x20001C08-&gt;l_table
           Fun-Dict 0x000030CB-&gt;QP::QHsm::top
           Fun-Dict 0x00002A79-&gt;Table::initial
           Fun-Dict 0x00002B8D-&gt;Table::active
           Fun-Dict 0x00002BB9-&gt;Table::serving
           Fun-Dict 0x00002E29-&gt;Table::paused
           Sig-Dict 00000005,Obj=0x00000000-&gt;DONE_SIG
           Sig-Dict 00000004,Obj=0x00000000-&gt;EAT_SIG
           Sig-Dict 00000006,Obj=0x00000000-&gt;PAUSE_SIG
           Sig-Dict 00000007,Obj=0x00000000-&gt;SERVE_SIG
           Sig-Dict 00000008,Obj=0x00000000-&gt;TEST_SIG
           Sig-Dict 00000010,Obj=0x20001C08-&gt;HUNGRY_SIG
. . .      . . .
</pre><p>Once QSPY acquires the dictionaries, it keeps them in the memory and applies them to display the data in symbolic form (rather than hex addresses).</p>
<dl class="section note"><dt>Note</dt><dd>The dictionaries do not need to be complete to be useful. QSPY simply applies the symbolic information whenever it can find a match in the dictionaries acquired so far. When a dictionary entry is not available, QSPY displays only hex addresses.</dd></dl>
<hr  />
 <h1><a class="anchor" id="qspy_dict_save"></a>
Saving Dictionaries to a File</h1>
<p>QSPY can save the dictionaries acquired thus far into a file. This must be triggered by the user (by means of the <code>d</code> <a class="el" href="qspy.html#qspy_keyboard">keyboard command</a> or from QSpyView menu "File-&gt;Save Dictionaries"), because QSPY does not "know" when the dictionaries are "complete", therefore it cannot know when to save them automatically.</p>
<dl class="section note"><dt>Note</dt><dd>For dictionaries to be saved to a file, the QSPY host application must be lauched with the <code>-d [file]</code> <a class="el" href="qspy.html#qspy_command">command-line option</a>, with of without the optional <code>[file]</code> parameter.</dd></dl>
<p>On the other hand, QSPY generates automatically the file name for saving dictionaries. This file name has always the form <code>qspy&lt;target-time-stamp&gt;.dic</code>, where <code>&lt;target-time-stamp&gt;</code> unambiguously identifies the Target build date and time. For example, the Target code last built on August 31, 2015 at 14:42:29 will have the name <code>qspy150831_144229.dic</code>.</p>
<dl class="section attention"><dt>Attention</dt><dd>The internal addresses of objects can change by every code re-build, so dictionaries are applicable only to the specific Target build and must be freshly re-acquired after every new Target code build.</dd></dl>
<p>The dictionaries are saved to a file in ASCII format. The following listing shows the dictionaries from the DPP example application running on the EK-TM4C123GXL board:</p>
<pre class="fragment">-v604
-T4
-O4
-F4
-S2
-E2
-Q1
-P2
-B2
-C2
-t180117_155932
Obj-Dic:
21 4
0x00007322 QS_RX
0x20000D3C l_SysTick_Handler
0x20000D3D l_GPIOPortA_IRQHandler
0x200015D0 smlPoolSto
0x20001620 philoQueueSto&lt;0&gt;
0x20001634 philoQueueSto&lt;1&gt;
0x20001648 philoQueueSto&lt;2&gt;
0x2000165C philoQueueSto&lt;3&gt;
0x20001670 philoQueueSto&lt;4&gt;
0x20001684 tableQueueSto
0x20001AEC l_philo&lt;0&gt;
0x20001B14 l_philo&lt;0&gt;.m_timeEvt
0x20001B24 l_philo&lt;1&gt;
0x20001B4C l_philo&lt;1&gt;.m_timeEvt
0x20001B5C l_philo&lt;2&gt;
0x20001B84 l_philo&lt;2&gt;.m_timeEvt
0x20001B94 l_philo&lt;3&gt;
0x20001BBC l_philo&lt;3&gt;.m_timeEvt
0x20001BCC l_philo&lt;4&gt;
0x20001BF4 l_philo&lt;4&gt;.m_timeEvt
0x20001C08 l_table
Fun-Dic:
9 4
0x000026C5 Philo::initial
0x000027E1 Philo::thinking
0x0000287D Philo::hungry
0x00002925 Philo::eating
0x00002A79 Table::initial
0x00002B8D Table::active
0x00002BB9 Table::serving
0x00002E29 Table::paused
0x000030CB QP::QHsm::top
Usr-Dic:
3 1
0x00000046 PHILO_STAT
0x00000047 PAUSED_STAT
0x00000048 COMMAND_STAT
Sig-Dic:
16 4
00000004 0x00000000 EAT_SIG
00000005 0x00000000 DONE_SIG
00000006 0x00000000 PAUSE_SIG
00000007 0x00000000 SERVE_SIG
00000008 0x00000000 TEST_SIG
00000010 0x20001B5C HUNGRY_SIG
00000010 0x20001BCC HUNGRY_SIG
00000010 0x20001B94 HUNGRY_SIG
00000010 0x20001AEC HUNGRY_SIG
00000010 0x20001B24 HUNGRY_SIG
00000010 0x20001C08 HUNGRY_SIG
00000011 0x20001B94 TIMEOUT_SIG
00000011 0x20001BCC TIMEOUT_SIG
00000011 0x20001B5C TIMEOUT_SIG
00000011 0x20001AEC TIMEOUT_SIG
00000011 0x20001B24 TIMEOUT_SIG
Msc-Dic:
0 4
</pre><hr  />
 <h1><a class="anchor" id="qspy_dict_use"></a>
Using Dictionary File</h1>
<p>The dictionary file saved in previous QSPY sessions can be used in two ways:</p>
<ul>
<li>you can specify the dictionary file in the <code>-d &lt;dictionary_file&gt;</code> <a class="el" href="qspy.html#qspy_command">command-line option</a> to QSPY. In this case QSPY reads the dictionaries from the provided <code>&lt;dictionary_file&gt;</code> before processing any trace records from the Target. (<b>NOTE:</b> in this case you don't need to provide any of the upper-case command-line options, because they are read from the dictionary file.) For example: command line: <code>qspy -d qspy180117_155932.dic</code> will attempt to read the dictionaries from the specified file.</li>
<li>you can specify the dictionary option without the dictionary file <code>-d</code> <a class="el" href="qspy.html#qspy_command">command-line option</a> to QSPY. Subsequently, once you run QSPY, you can query the Target information (by means of the <code>i</code> or <code>r</code> <a class="el" href="qspy.html#qspy_keyboard">keyboard command</a> or from QSpyView menu "Commands-&gt;Query Target Info"). When the Target replies and provides its build-time-stamp, QSPY looks for the corresponding dictionary file in the current directory and if such a file is found, QSPY reads the dictionaries from it. (<b>NOTE:</b> this option requires that the Target implements the QS receive channel, QS-RX, so that it can receive commands from QSPY).</li>
</ul>
<hr  />
<p><b>Next:</b> <a class="el" href="qspy_udp.html">QSPY UDP Interface</a></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QTools 6.8.0</b>
    </li>
  </ul>
</div>
</body>
</html>
