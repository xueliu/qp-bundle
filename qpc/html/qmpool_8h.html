<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QP/C: qmpool.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ql.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a id="logo" title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com"></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QP/C
   &#160;<span id="projectnumber">6.8.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('qmpool_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">qmpool.h File Reference<div class="ingroups"><a class="el" href="group__qf.html">QF</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>QP native, platform-independent memory pool <a class="el" href="qmpool_8h.html#struct_q_m_pool" title="Native QF Memory Pool.">QMPool</a> interface.
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="qmpool_8h__dep__incl.png" border="0" usemap="#qmpool_8hdep" alt=""/></div>
<map name="qmpool_8hdep" id="qmpool_8hdep">
<area shape="rect" title="QP native, platform&#45;independent memory pool QMPool interface." alt="" coords="502,5,577,32"/>
<area shape="rect" href="qk_8h.html" title="QK/C (preemptive non&#45;blocking kernel) platform&#45;independent public interface." alt="" coords="431,80,477,107"/>
<area shape="rect" href="qv_8h.html" title="QV/C (cooperative &quot;Vanilla&quot; kernel) platform&#45;independent public interface." alt="" coords="517,80,562,107"/>
<area shape="rect" href="qxk_8h.html" title="QXK/C (preemptive dual&#45;mode kernel) platform&#45;independent public interface." alt="" coords="600,80,655,107"/>
<area shape="rect" href="qk__port_8h.html" title="QK/C port example for a generic C compiler." alt="" coords="401,155,477,181"/>
<area shape="rect" href="qk_2qf__port_8h.html" title="QF/C port example for QK, generic C compiler." alt="" coords="403,229,475,256"/>
<area shape="rect" href="qv__port_8h.html" title="QV/C port example for a generic C compiler." alt="" coords="502,155,577,181"/>
<area shape="rect" href="qv_2qf__port_8h.html" title="QF/C port example for QV, generic C compiler." alt="" coords="503,229,575,256"/>
<area shape="rect" href="qxk__port_8h.html" title="QXK/C port example for a generic C compiler." alt="" coords="601,155,683,181"/>
<area shape="rect" href="qxk_2qf__port_8h.html" title="QF/C port example for QXK, generic C compiler." alt="" coords="606,229,678,256"/>
<area shape="rect" href="qpc_8h.html" title="QP/C public interface including backwards&#45;compatibility layer." alt="" coords="5,379,60,405"/>
<area shape="rect" href="qf__act_8c.html" title="QActive services and ::QF support code" alt="" coords="84,379,152,405"/>
<area shape="rect" href="qf__actq_8c.html" title="QActive native queue operations (based on QEQueue)" alt="" coords="177,379,251,405"/>
<area shape="rect" href="qf__defer_8c.html" title="QActive_defer() and QActive_recall() implementation." alt="" coords="276,379,355,405"/>
<area shape="rect" href="qf__dyn_8c.html" title="QF/C dynamic event management." alt="" coords="379,379,449,405"/>
<area shape="rect" href="qf__mem_8c.html" title="QMPool implementatin (Memory Pool)" alt="" coords="473,379,552,405"/>
<area shape="rect" href="qf__ps_8c.html" title="Publish&#45;Subscribe services." alt="" coords="577,379,641,405"/>
<area shape="rect" href="qf__qact_8c.html" title="QActive_ctor() definition." alt="" coords="933,304,1007,331"/>
<area shape="rect" href="qf__qeq_8c.html" title="QEQueue implementation (QP native thread&#45;safe queue)" alt="" coords="665,379,736,405"/>
<area shape="rect" href="qf__qmact_8c.html" title="QMActive_ctor() definition." alt="" coords="1032,304,1119,331"/>
<area shape="rect" href="qf__time_8c.html" title="QTimeEvt implementation and QF system clock tick QF_tickX_())" alt="" coords="1343,379,1418,405"/>
<area shape="rect" href="qutest_8c.html" title="QF/C stub for QUTEST unit testing." alt="" coords="1442,379,1511,405"/>
<area shape="rect" href="qv_8c.html" title="Cooperative QV kernel, definition of QP::QV_readySet_ and implementation of kernel&#45;specific functions..." alt="" coords="1535,379,1581,405"/>
<area shape="rect" href="qs__port_8h.html" title="QS/C port to a 32&#45;bit CPU and a generic C compiler." alt="" coords="1143,304,1219,331"/>
<area shape="rect" href="qxk_2qs__port_8h.html" title="QS/C port to a 32&#45;bit CPU and a generic C compiler." alt="" coords="680,304,756,331"/>
<area shape="rect" href="qep__hsm_8c.html" title="QHsm implementation" alt="" coords="1045,379,1132,405"/>
<area shape="rect" href="qep__msm_8c.html" title="QMsm implementation" alt="" coords="1157,379,1247,405"/>
<area shape="rect" href="qs_8c.html" title="QS software tracing services." alt="" coords="1272,379,1319,405"/>
<area shape="rect" href="qs__64bit_8c.html" title="QS long&#45;long (64&#45;bit) output." alt="" coords="761,379,843,405"/>
<area shape="rect" href="qs__fp_8c.html" title="QS floating point output implementation." alt="" coords="867,379,931,405"/>
<area shape="rect" href="qs__rx_8c.html" title="QS/C receive channel services." alt="" coords="956,379,1021,405"/>
</map>
</div>
</div>
<p><a href="qmpool_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:struct_q_m_pool"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qmpool_8h.html#struct_q_m_pool">QMPool</a></td></tr>
<tr class="memdesc:struct_q_m_pool"><td class="mdescLeft">&#160;</td><td class="mdescRight">Native QF Memory Pool.  <a href="qmpool_8h.html#struct_q_m_pool">More...</a><br /></td></tr>
<tr class="separator:struct_q_m_pool"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab0fe475154021674f904c52e61e78841"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qmpool_8h.html#ab0fe475154021674f904c52e61e78841">QF_MPOOL_EL</a>(evType_)&#160;&#160;&#160;struct { void *sto_[((sizeof(evType_) - 1U)/sizeof(void*)) + 1U]; }</td></tr>
<tr class="memdesc:ab0fe475154021674f904c52e61e78841"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory pool element to allocate correctly aligned storage for <a class="el" href="qmpool_8h.html#struct_q_m_pool" title="Native QF Memory Pool.">QMPool</a> class.  <a href="qmpool_8h.html#ab0fe475154021674f904c52e61e78841">More...</a><br /></td></tr>
<tr class="separator:ab0fe475154021674f904c52e61e78841"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ab937ed65c2c800fad079cf296803a539"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="16bit_2stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qmpool_8h.html#ab937ed65c2c800fad079cf296803a539">QMPoolSize</a></td></tr>
<tr class="memdesc:ab937ed65c2c800fad079cf296803a539"><td class="mdescLeft">&#160;</td><td class="mdescRight">The data type to store the block-size based on the macro <a class="el" href="qxk_2qf__port_8h.html#ac41e4f294d103c68521f9ad1f8e4e3b4" title="The size (in bytes) of the block-size representation in the native QF event pool.">QF_MPOOL_SIZ_SIZE</a>.  <a href="qmpool_8h.html#ab937ed65c2c800fad079cf296803a539">More...</a><br /></td></tr>
<tr class="separator:ab937ed65c2c800fad079cf296803a539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbbaf428a11178e4ba14574253cac116"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="16bit_2stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qmpool_8h.html#acbbaf428a11178e4ba14574253cac116">QMPoolCtr</a></td></tr>
<tr class="memdesc:acbbaf428a11178e4ba14574253cac116"><td class="mdescLeft">&#160;</td><td class="mdescRight">The data type to store the block-counter based on the macro <a class="el" href="qxk_2qf__port_8h.html#adc446a34e9e682fc5e821d203f73a6e0" title="The size (in bytes) of the block-counter representation in the native QF event pool.">QF_MPOOL_CTR_SIZE</a>.  <a href="qmpool_8h.html#acbbaf428a11178e4ba14574253cac116">More...</a><br /></td></tr>
<tr class="separator:acbbaf428a11178e4ba14574253cac116"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a19ce0f12f82dcf6825628ace98e980dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qmpool_8h.html#a19ce0f12f82dcf6825628ace98e980dc">QMPool_init</a> (<a class="el" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> *const me, void *const poolSto, <a class="el" href="16bit_2stdint_8h.html#aeb3ae59c7d101507a3952f5de306ea95">uint_fast32_t</a> poolSize, <a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a> blockSize)</td></tr>
<tr class="memdesc:a19ce0f12f82dcf6825628ace98e980dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the native QF memory pool.  <a href="qmpool_8h.html#a19ce0f12f82dcf6825628ace98e980dc">More...</a><br /></td></tr>
<tr class="separator:a19ce0f12f82dcf6825628ace98e980dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76cbc3e7493ea05d944799c126b819a9"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qmpool_8h.html#a76cbc3e7493ea05d944799c126b819a9">QMPool_get</a> (<a class="el" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> *const me, <a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a> const margin)</td></tr>
<tr class="memdesc:a76cbc3e7493ea05d944799c126b819a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains a memory block from a memory pool.  <a href="qmpool_8h.html#a76cbc3e7493ea05d944799c126b819a9">More...</a><br /></td></tr>
<tr class="separator:a76cbc3e7493ea05d944799c126b819a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a2037d4843f9d1eab63c0ebd7fe302"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302">QMPool_put</a> (<a class="el" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> *const me, void *b)</td></tr>
<tr class="memdesc:aa4a2037d4843f9d1eab63c0ebd7fe302"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recycles a memory block back to a memory pool.  <a href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302">More...</a><br /></td></tr>
<tr class="separator:aa4a2037d4843f9d1eab63c0ebd7fe302"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>QP native, platform-independent memory pool <a class="el" href="qmpool_8h.html#struct_q_m_pool" title="Native QF Memory Pool.">QMPool</a> interface. </p>

<p class="definition">Definition in file <a class="el" href="qmpool_8h_source.html">qmpool.h</a>.</p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="struct_q_m_pool" id="struct_q_m_pool"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_q_m_pool">&#9670;&nbsp;</a></span>QMPool</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct QMPool</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Native QF Memory Pool. </p>
<dl class="section user"><dt>Description</dt><dd>A fixed block-size memory pool is a very fast and efficient data structure for dynamic allocation of fixed block-size chunks of memory. A memory pool offers fast and deterministic allocation and recycling of memory blocks and is not subject to fragmenation.<br  />
<br  />
The <a class="el" href="qmpool_8h.html#struct_q_m_pool" title="Native QF Memory Pool.">QMPool</a> class describes the native QF memory pool, which can be used as the event pool for dynamic event allocation, or as a fast, deterministic fixed block-size heap for any other objects in your application.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="qmpool_8h.html#struct_q_m_pool" title="Native QF Memory Pool.">QMPool</a> contains only data members for managing a memory pool, but does not contain the pool storage, which must be provided externally during the pool initialization.</dd>
<dd>
The native QF event pool is configured by defining the macro <a class="el" href="qxk_8h.html#ab786be96ee118929bfb4dcd51d3acce5">QF_EPOOL_TYPE_</a> as <a class="el" href="qmpool_8h.html#struct_q_m_pool" title="Native QF Memory Pool.">QMPool</a> in the specific QF port header file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qmpool_8h_source.html#l00118">118</a> of file <a class="el" href="qmpool_8h_source.html">qmpool.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for QMPool:</div>
<div class="dyncontent">
<div class="center"><img src="struct_q_m_pool__coll__graph.png" border="0" usemap="#_q_m_pool_coll__map" alt="Collaboration graph"/></div>
<map name="_q_m_pool_coll__map" id="_q_m_pool_coll__map">
<area shape="rect" title="Native QF Memory Pool." alt="" coords="5,5,96,171"/>
</map>
</div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a975ccf44de4a438a37792ae7c518ca65"></a>void *volatile</td>
<td class="fieldname">
free_head</td>
<td class="fielddoc">
The head of the linked list of free blocks. </td></tr>
<tr><td class="fieldtype">
<a id="a53255b934b07b472175fbb8e847f9b5d"></a>void *</td>
<td class="fieldname">
start</td>
<td class="fielddoc">
the original start this pool </td></tr>
<tr><td class="fieldtype">
<a id="a57dfa4d169c6b9c0b4e7352bc0c34366"></a>void *</td>
<td class="fieldname">
end</td>
<td class="fielddoc">
the last memory block managed by this memory pool </td></tr>
<tr><td class="fieldtype">
<a id="a48af259d19f4cabaa01773702daf1e60"></a><a class="el" href="qmpool_8h.html#ab937ed65c2c800fad079cf296803a539">QMPoolSize</a></td>
<td class="fieldname">
blockSize</td>
<td class="fielddoc">
maximum block size (in bytes) </td></tr>
<tr><td class="fieldtype">
<a id="af0ffe3837793955c37bdb0587f365556"></a><a class="el" href="qmpool_8h.html#acbbaf428a11178e4ba14574253cac116">QMPoolCtr</a></td>
<td class="fieldname">
nTot</td>
<td class="fielddoc">
total number of blocks </td></tr>
<tr><td class="fieldtype">
<a id="a463f7c9b346c1e4fa67f0fba662fcf5b"></a><a class="el" href="qmpool_8h.html#acbbaf428a11178e4ba14574253cac116">QMPoolCtr</a> volatile</td>
<td class="fieldname">
nFree</td>
<td class="fielddoc">
number of free blocks remaining </td></tr>
<tr><td class="fieldtype">
<a id="a661dfb0f9495c37b30c89fca86e8175e"></a><a class="el" href="qmpool_8h.html#acbbaf428a11178e4ba14574253cac116">QMPoolCtr</a></td>
<td class="fieldname">
nMin</td>
<td class="fielddoc">
minimum number of free blocks ever present in this pool <dl class="section user"><dt>Description</dt><dd>this attribute remembers the low watermark of the pool, which provides a valuable information for sizing event pools. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="qf_8h.html#ae52d81b1bd2cab6523fbe13cb5d79190" title="Obtain the minimum of free entries of the given event pool.">QF_getPoolMin()</a>. </dd></dl>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab0fe475154021674f904c52e61e78841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0fe475154021674f904c52e61e78841">&#9670;&nbsp;</a></span>QF_MPOOL_EL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define QF_MPOOL_EL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">evType_</td><td>)</td>
          <td>&#160;&#160;&#160;struct { void *sto_[((sizeof(evType_) - 1U)/sizeof(void*)) + 1U]; }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Memory pool element to allocate correctly aligned storage for <a class="el" href="qmpool_8h.html#struct_q_m_pool" title="Native QF Memory Pool.">QMPool</a> class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">evType_</td><td>event type (name of the subclass of <a class="el" href="qep_8h.html#struct_q_evt" title="Event structure.">QEvt</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="qmpool_8h_source.html#l00165">165</a> of file <a class="el" href="qmpool_8h_source.html">qmpool.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ab937ed65c2c800fad079cf296803a539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab937ed65c2c800fad079cf296803a539">&#9670;&nbsp;</a></span>QMPoolSize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="16bit_2stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="el" href="qmpool_8h.html#ab937ed65c2c800fad079cf296803a539">QMPoolSize</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The data type to store the block-size based on the macro <a class="el" href="qxk_2qf__port_8h.html#ac41e4f294d103c68521f9ad1f8e4e3b4" title="The size (in bytes) of the block-size representation in the native QF event pool.">QF_MPOOL_SIZ_SIZE</a>. </p>
<dl class="section user"><dt>Description</dt><dd>The dynamic range of this data type determines the maximum size of blocks that can be managed by the native QF event pool. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qmpool_8h_source.html#l00060">60</a> of file <a class="el" href="qmpool_8h_source.html">qmpool.h</a>.</p>

</div>
</div>
<a id="acbbaf428a11178e4ba14574253cac116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbbaf428a11178e4ba14574253cac116">&#9670;&nbsp;</a></span>QMPoolCtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="16bit_2stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> <a class="el" href="qmpool_8h.html#acbbaf428a11178e4ba14574253cac116">QMPoolCtr</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The data type to store the block-counter based on the macro <a class="el" href="qxk_2qf__port_8h.html#adc446a34e9e682fc5e821d203f73a6e0" title="The size (in bytes) of the block-counter representation in the native QF event pool.">QF_MPOOL_CTR_SIZE</a>. </p>
<dl class="section user"><dt>Description</dt><dd>The dynamic range of this data type determines the maximum number of blocks that can be stored in the pool. </dd></dl>

<p class="definition">Definition at line <a class="el" href="qmpool_8h_source.html#l00087">87</a> of file <a class="el" href="qmpool_8h_source.html">qmpool.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a19ce0f12f82dcf6825628ace98e980dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ce0f12f82dcf6825628ace98e980dc">&#9670;&nbsp;</a></span>QMPool_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QMPool_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>poolSto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#aeb3ae59c7d101507a3952f5de306ea95">uint_fast32_t</a>&#160;</td>
          <td class="paramname"><em>poolSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a>&#160;</td>
          <td class="paramname"><em>blockSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the native QF memory pool. </p>
<dl class="section user"><dt>Description</dt><dd>Initialize a fixed block-size memory pool by providing it with the pool memory to manage, size of this memory, and the block size.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">poolSto</td><td>pointer to the memory buffer for pool storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">poolSize</td><td>size of the storage buffer in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockSize</td><td>fixed-size of the memory blocks in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section attention"><dt>Attention</dt><dd>The caller of QMPool::init() must make sure that the <code>poolSto</code> pointer is properly <b>aligned</b>. In particular, it must be possible to efficiently store a pointer at the location pointed to by <code>poolSto</code>. Internally, the <a class="el" href="qf__mem_8c.html#a19ce0f12f82dcf6825628ace98e980dc" title="Initializes the native QF memory pool.">QMPool_init()</a> function rounds up the block size <code>blockSize</code> so that it can fit an integer number of pointers. This is done to achieve proper alignment of the blocks within the pool.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Due to the rounding of block size the actual capacity of the pool might be less than (<code>poolSize</code> / <code>blockSize</code>). You can check the capacity of the pool by calling the <a class="el" href="qf__mem_8c.html#ae52d81b1bd2cab6523fbe13cb5d79190" title="Obtain the minimum of free entries of the given event pool.">QF_getPoolMin()</a> function.</dd>
<dd>
This function is <b>not</b> protected by a critical section, because it is intended to be called only during the initialization of the system, when interrupts are not allowed yet.</dd>
<dd>
Many QF ports use memory pools to implement the event pools.</dd></dl>
<dl class="section user"><dt>Usage</dt><dd>The following example illustrates how to invoke <a class="el" href="qf__mem_8c.html#a19ce0f12f82dcf6825628ace98e980dc" title="Initializes the native QF memory pool.">QMPool_init()</a>: <div class="fragment"><div class="line"><a class="code" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> myMemPool1; <span class="comment">/* memory pool object #1 (global) */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="16bit_2stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> memPoolSto1[512]; <span class="comment">/* storage for a memory pool #1 */</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> myMemPool2; <span class="comment">/* memory pool object #2 (global) */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="16bit_2stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> memPoolSto2[1024]; <span class="comment">/* storage for a memory pool #2 */</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="qmpool_8h.html#a19ce0f12f82dcf6825628ace98e980dc">QMPool_init</a>(&amp;myMemPool1,</div>
<div class="line">            memPoolSto1,</div>
<div class="line">            <span class="keyword">sizeof</span>(memPoolSto1),</div>
<div class="line">            10U);  <span class="comment">/* memory blocks of 10 bytes each */</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="qmpool_8h.html#a19ce0f12f82dcf6825628ace98e980dc">QMPool_init</a>(&amp;myMemPool2,</div>
<div class="line">            memPoolSto2,</div>
<div class="line">            <span class="keyword">sizeof</span>(memPoolSto2),</div>
<div class="line">            25U);  <span class="comment">/* memory blocks of 25 bytes each */</span></div>
</div><!-- fragment --> </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>The memory block must be valid and the poolSize must fit at least one free block and the blockSize must not be too close to the top of the dynamic range</dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__mem_8c_source.html#l00089">89</a> of file <a class="el" href="qf__mem_8c_source.html">qf_mem.c</a>.</p>

</div>
</div>
<a id="a76cbc3e7493ea05d944799c126b819a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76cbc3e7493ea05d944799c126b819a9">&#9670;&nbsp;</a></span>QMPool_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* QMPool_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="16bit_2stdint_8h.html#a226d967fb6d06433caf43f20dc876aae">uint_fast16_t</a> const&#160;</td>
          <td class="paramname"><em>margin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtains a memory block from a memory pool. </p>
<dl class="section user"><dt>Description</dt><dd>The function allocates a memory block from the pool and returns a pointer to the block back to the caller.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">margin</td><td>the minimum number of unused blocks still available in the pool after the allocation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function can be called from any task level or ISR level.</dd>
<dd>
The memory pool <code>me</code> must be initialized before any events can be requested from it. Also, the <a class="el" href="qf__mem_8c.html#a76cbc3e7493ea05d944799c126b819a9" title="Obtains a memory block from a memory pool.">QMPool_get()</a> function uses internally a QF critical section, so you should be careful not to call it from within a critical section when nesting of critical section is not supported.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>An allocated block must be later returned back to the same pool from which it has been allocated.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="qf__mem_8c.html#aa4a2037d4843f9d1eab63c0ebd7fe302" title="Recycles a memory block back to a memory pool.">QMPool_put()</a></dd></dl>
<dl class="section user"><dt>Usage</dt><dd>The following example illustrates how to use <a class="el" href="qf__mem_8c.html#a76cbc3e7493ea05d944799c126b819a9" title="Obtains a memory block from a memory pool.">QMPool_get()</a>: <div class="fragment"><div class="line"><span class="keywordtype">void</span> *block1 = <a class="code" href="qmpool_8h.html#a76cbc3e7493ea05d944799c126b819a9">QMPool_get</a>(&amp;myMemPool1, 0U); <span class="comment">/* asserts on empty pool */</span></div>
<div class="line"><span class="comment">/* block1 is guaranteed to be not NULL */</span></div>
<div class="line">~ ~ ~<a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302"></a></div>
<div class="line"><a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302">QMPool_put</a>(&amp;myMemPool1, block1);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> *block2 = QMpool_get(&amp;myMemPool2, 5U); <span class="comment">/* non-asserting version */</span></div>
<div class="line"><span class="keywordflow">if</span> (block2 != (<span class="keywordtype">void</span> *)0) { <span class="comment">/* allocation succeeded? */</span></div>
<div class="line">   ~ ~ ~</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">~ ~ ~<a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302"></a></div>
<div class="line"><a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302">QMPool_put</a>(&amp;myMemPool2, block2);</div>
</div><!-- fragment --> </dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__mem_8c_source.html#l00211">211</a> of file <a class="el" href="qf__mem_8c_source.html">qf_mem.c</a>.</p>

</div>
</div>
<a id="aa4a2037d4843f9d1eab63c0ebd7fe302"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a2037d4843f9d1eab63c0ebd7fe302">&#9670;&nbsp;</a></span>QMPool_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void QMPool_put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="qmpool_8h.html#struct_q_m_pool">QMPool</a> *const&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recycles a memory block back to a memory pool. </p>
<dl class="section user"><dt>Description</dt><dd>Recycle a memory block to the fixed block-size memory pool.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">me</td><td>pointer (see <a class="el" href="index.html#oop">Object Orientation</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>pointer to the memory block that is being recycled</td></tr>
  </table>
  </dd>
</dl>
<dl class="section attention"><dt>Attention</dt><dd>The recycled block must be allocated from the <b>same</b> memory pool to which it is returned.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function can be called from any task level or ISR level.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="qf__mem_8c.html#a76cbc3e7493ea05d944799c126b819a9" title="Obtains a memory block from a memory pool.">QMPool_get()</a></dd></dl>
<dl class="section user"><dt>Usage</dt><dd>The following example illustrates how to use <a class="el" href="qf__mem_8c.html#aa4a2037d4843f9d1eab63c0ebd7fe302" title="Recycles a memory block back to a memory pool.">QMPool_put()</a>: <div class="fragment"><div class="line"><span class="keywordtype">void</span> *block1 = <a class="code" href="qmpool_8h.html#a76cbc3e7493ea05d944799c126b819a9">QMPool_get</a>(&amp;myMemPool1, 0U); <span class="comment">/* asserts on empty pool */</span></div>
<div class="line"><span class="comment">/* block1 is guaranteed to be not NULL */</span></div>
<div class="line">~ ~ ~<a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302"></a></div>
<div class="line"><a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302">QMPool_put</a>(&amp;myMemPool1, block1);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> *block2 = QMpool_get(&amp;myMemPool2, 5U); <span class="comment">/* non-asserting version */</span></div>
<div class="line"><span class="keywordflow">if</span> (block2 != (<span class="keywordtype">void</span> *)0) { <span class="comment">/* allocation succeeded? */</span></div>
<div class="line">   ~ ~ ~</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">~ ~ ~<a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302"></a></div>
<div class="line"><a class="code" href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302">QMPool_put</a>(&amp;myMemPool2, block2);</div>
</div><!-- fragment --> </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd># free blocks cannot exceed the total # blocks and the block pointer must be from this pool.</dd></dl>

<p class="definition">Definition at line <a class="el" href="qf__mem_8c_source.html#l00159">159</a> of file <a class="el" href="qf__mem_8c_source.html">qf_mem.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="a16bit_2stdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="16bit_2stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdoc">exact-width 8-bit unsigned int</div><div class="ttdef"><b>Definition:</b> <a href="16bit_2stdint_8h_source.html#l00029">16bit/stdint.h:29</a></div></div>
<div class="ttc" id="aqmpool_8h_html_a76cbc3e7493ea05d944799c126b819a9"><div class="ttname"><a href="qmpool_8h.html#a76cbc3e7493ea05d944799c126b819a9">QMPool_get</a></div><div class="ttdeci">void * QMPool_get(QMPool *const me, uint_fast16_t const margin)</div><div class="ttdoc">Obtains a memory block from a memory pool.</div><div class="ttdef"><b>Definition:</b> <a href="qf__mem_8c_source.html#l00211">qf_mem.c:211</a></div></div>
<div class="ttc" id="aqmpool_8h_html_a19ce0f12f82dcf6825628ace98e980dc"><div class="ttname"><a href="qmpool_8h.html#a19ce0f12f82dcf6825628ace98e980dc">QMPool_init</a></div><div class="ttdeci">void QMPool_init(QMPool *const me, void *const poolSto, uint_fast32_t poolSize, uint_fast16_t blockSize)</div><div class="ttdoc">Initializes the native QF memory pool.</div><div class="ttdef"><b>Definition:</b> <a href="qf__mem_8c_source.html#l00089">qf_mem.c:89</a></div></div>
<div class="ttc" id="aqmpool_8h_html_aa4a2037d4843f9d1eab63c0ebd7fe302"><div class="ttname"><a href="qmpool_8h.html#aa4a2037d4843f9d1eab63c0ebd7fe302">QMPool_put</a></div><div class="ttdeci">void QMPool_put(QMPool *const me, void *b)</div><div class="ttdoc">Recycles a memory block back to a memory pool.</div><div class="ttdef"><b>Definition:</b> <a href="qf__mem_8c_source.html#l00159">qf_mem.c:159</a></div></div>
<div class="ttc" id="aqmpool_8h_html_struct_q_m_pool"><div class="ttname"><a href="qmpool_8h.html#struct_q_m_pool">QMPool</a></div><div class="ttdoc">Native QF Memory Pool.</div><div class="ttdef"><b>Definition:</b> <a href="qmpool_8h_source.html#l00118">qmpool.h:118</a></div></div>
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
<a title="Quantum Leaps: Modern Embedded Software" href="https://www.state-machine.com">&copy; Quantum Leaps 2020</a> &nbsp;| &nbsp; <a title="help" href="help.html">Using Online Help</a>&nbsp;| &nbsp;<a title="Doxygen" href="http://www.doxygen.nl">Generated with Doxygen</a>&nbsp; | &nbsp;<b>QP/C 6.8.0</b>
    </li>
  </ul>
</div>
</body>
</html>
